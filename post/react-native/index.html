<!DOCTYPE html>
<html lang="en" class="post">
<head>
	<meta charset="UTF-8">
	<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
	<meta name='renderer' content='webkit'>
	<meta name='viewport' content='width=device-width, initial-scale=1.0,maximum-scale=1.0, user-scalable=no'>
	<meta name='description' content='记录学习的点点滴滴'>
	<meta name='keywords' content='前端,PHP,GO,编程博客'>
	<title>react native &middot; 苏苏的博客</title>
	<link rel="stylesheet" type="text/css" href="/css/style.css">
	<link href='' rel="alternate" type="application/rss+xml" title="苏苏的博客" />
	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/favicon.png">
	<link rel="shortcut icon" href="/favicon.png">
</head>
<body>
<header class="header post-header">
    <div class="header-main" >
        <a href="/"><img src="/img/avatar.jpg" class="header-avatar"></a>
        <h1>苏苏的博客</h1>
        <p class="sub-title">简约至极</p>
        <ul class="menus">
            <a href="/">首页</a>
            <a href="/post">技术</a>
            <a href="/life">生活</a>
            <a href="/photo">相册</a>
            <a href="/about">关于</a>
        </ul>
    </div>
    
</header>
<div class="content container center">
	<div class="post">
		<h1 class="post-title">
			react native
        </h1>
        <div class="post-meta">
            <div>
                <p class="post-date">
                    <svg style="width: 26px; height: 16px;position:relative;top:3px;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1946" data-spm-anchor-id="a313x.7781069.0.i0"><path d="M959.381795 958.445982l-895.392924 0 0-740.873688 895.392924 0L959.381795 958.445982zM89.571527 932.863327l844.227614 0 0-689.708378-844.227614 0L89.571527 932.863327z" p-id="1947"></path><path d="M268.650111 64.076364l25.582655 0 0 267.082918-25.582655 0 0-267.082918Z" p-id="1948"></path><path d="M729.137901 64.076364l25.582655 0 0 267.082918-25.582655 0 0-267.082918Z" p-id="1949"></path><path d="M88.54822 408.930553l845.25092 0 0 25.582655-845.25092 0 0-25.582655Z" p-id="1950"></path><path d="M586.898339 651.454122l-139.169643 0 0-114.610294 139.169643 0L586.898339 651.454122zM473.311351 625.871467l88.004333 0 0-63.444984-88.004333 0L473.311351 625.871467z" p-id="1951"></path><path d="M586.898339 831.556013l-139.169643 0 0-115.6336 139.169643 0L586.898339 831.556013zM473.311351 805.973358l88.004333 0 0-64.46829-88.004333 0L473.311351 805.973358z" p-id="1952"></path><path d="M319.815421 651.454122l-141.216255 0 0-114.610294 141.216255 0L319.815421 651.454122zM204.181821 625.871467l90.050945 0 0-63.444984-90.050945 0L204.181821 625.871467z" p-id="1953"></path><path d="M319.815421 831.556013l-141.216255 0 0-115.6336 141.216255 0L319.815421 831.556013zM204.181821 805.973358l90.050945 0 0-64.46829-90.050945 0L204.181821 805.973358z" p-id="1954"></path><path d="M856.027869 651.454122l-139.169643 0 0-114.610294 139.169643 0L856.027869 651.454122zM742.440881 625.871467l88.004333 0 0-63.444984-88.004333 0L742.440881 625.871467z" p-id="1955"></path><path d="M856.027869 831.556013l-139.169643 0 0-115.6336 139.169643 0L856.027869 831.556013zM742.440881 805.973358l88.004333 0 0-64.46829-88.004333 0L742.440881 805.973358z" p-id="1956"></path></svg>
                    2016/07/11 11:39 Mon
                </p>
            </div>

            
            

            
            
        </div>
        
		<div class="post-text">
			<h2 id="react-native">react native</h2>
<h3 id="环境准备">环境准备</h3>
<p>前提是需要node和npm,这里不在赘述.介绍一个npm加速的.</p>
<p>使用淘宝的npm镜像.控制台运行,或者加入你的bashrc中永久生效</p>
<pre><code>alias cnpm=&quot;npm --registry=https://registry.npm.taobao.org --cache=$HOME/.npm/.cache/cnpm --disturl=https://npm.taobao.org/dist --userconfig=$HOME/.cnpmrc&quot;;
</code></pre><p>安装开发必备的一些package</p>
<pre><code>cnpm install -g react-native-cli webpack
</code></pre><p><code>react-native</code>也调用了<code>npm</code>命令,所以我们可以再来个alias加速<code>react-native init</code></p>
<p><code>alias npm='cnpm'</code></p>
<p>或者直接将仓库改为淘宝的NPM镜像</p>
<pre><code>npm config set registry https://registry.npm.taobao.org
npm config set disturl https://npm.taobao.org/dist
</code></pre><p>在mac上还需要一些东西</p>
<pre><code>brew install flow watchman
</code></pre><p>安装完以后可以开始helloworld了.</p>
<h3 id="开始第一个例子">开始第一个例子</h3>
<pre><code>cd /data/tmp
react-native init HelloWorld
</code></pre><p>然后正在初始化大致如下</p>
<pre><code>This will walk you through creating a new React Native project in /data/tmp/HelloWorld
Installing react-native package from npm...
Setting up new React Native app in /data/tmp/HelloWorld
HelloWorld@0.0.1 /data/tmp/HelloWorld
└── react@15.2.1

To run your app on iOS:
   cd /data/tmp/HelloWorld
   react-native run-ios
   - or -
   Open /data/tmp/HelloWorld/ios/HelloWorld.xcodeproj in Xcode
   Hit the Run button
To run your app on Android:
   Have an Android emulator running (quickest way to get started), or a device connected
   cd /data/tmp/HelloWorld
   react-native run-android
</code></pre><p>使用<code>React</code>类名(组件名)必须首字母大写才会被认为是一个组件,否则在JSX里只会当做普通标签</p>
<p><strong>下面是一些针对开发IOS的教程</strong></p>
<p>我们执行<code>react-native run-ios</code>开始编译运行,前提是你必须安装了<code>xcode</code>哦.</p>
<p>执行后,出现<code>BUILD SUCCEEDED</code>,同时自动打开新的终端运行了一个server在8081端口.</p>
<p>模拟器中也会出现刚编译好的app的窗口,使用<code>cmd+r</code>刷新,<code>cmd+d</code>弹出开发菜单.</p>
<p>我们可以修改<code>index.ios.js</code>开始开发了.</p>
<p><strong>下面是一些针对开发Android的教程</strong></p>
<h3 id="问题">问题</h3>
<p>在使用<code>fetch</code>调用接口时,可能会出现<code>The resource could not be loaded because the App Transport Security policy requires the use of a secure connection.</code>错误</p>
<p>这是IOS9要求必须使用https通信,需要修改 <a href="http://stackoverflow.com/questions/30731785/how-do-i-load-an-http-url-with-app-transport-security-enabled-in-ios-9">http://stackoverflow.com/questions/30731785/how-do-i-load-an-http-url-with-app-transport-security-enabled-in-ios-9</a></p>
<p>其实<code>react native</code>创建<code>Info.plist</code>时就已经为我们说明了,在<code>NSExceptionDomains</code>下面的<code>dict</code>里添加一个排除域名就OK了.</p>
<p>注意,不能将默认的<code>localhost</code>去掉,否则会出现<code>_fbBatchedBridge is undefined</code>错误.</p>
<h2 id="打包">打包</h2>
<h3 id="对android项目打包">对android项目打包</h3>
<p>使用<code>keytool</code>生成签名文件,在任意目录下执行</p>
<pre><code>keytool -genkey -v -keystore my-release-key.keystore  -alias my-key-alias -keyalg RSA -keysize 2048 -validity 10000
</code></pre><p>上面<code>my-release-key</code>可以自己定义,后面的<code>my-key-alias</code>也可以自己定义.运行后输入一下相关信息后,生成<code>my-release-key.keystore</code>文件.</p>
<p>其中输入的两次密码,需要记住.将这个文件移动到<code>android/app</code>目录下,编译<code>android/app</code>里的<code>build.gradle</code>,添加下面的内容</p>
<pre><code>android {
    ...
    defaultConfig { ... }
    signingConfigs {
        release {
            storeFile file(MYAPP_RELEASE_STORE_FILE)
            storePassword MYAPP_RELEASE_STORE_PASSWORD
            keyAlias MYAPP_RELEASE_KEY_ALIAS
            keyPassword MYAPP_RELEASE_KEY_PASSWORD
        }
    }
    ...
    buildTypes {
        release {
              ...
              signingConfig signingConfigs.release
        }
    }
}
</code></pre><p>在<code>android</code>目录下运行如下命令,就可以打包,安装到自己手机上,前提是手机已usb调试连接到电脑</p>
<pre><code>./gradlew assembleRelease
cd app/build/outputs/apk
adb install -r app-release.apk
</code></pre><p>参考 <a href="https://facebook.github.io/react-native/docs/signed-apk-android.html">https://facebook.github.io/react-native/docs/signed-apk-android.html</a></p>

		</div>
    </div>
    <div class="post-comment comment-render">
        <air-messager ns="hi" thread="/post/react-native/"></air-messager>
    </div>
    <div class="post-end">
        
            <a class="previous" href="/post/some-hole/" title="微信浏览器的一些问题" >
                <svg t="1542528774445" class="icon" style="width: 1em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1114"><path d="M532.526499 904.817574L139.506311 511.797385 532.526499 118.777197c12.258185-12.258185 12.432147-32.892131-0.187265-45.51052-12.707416-12.707416-32.995485-12.703323-45.511543-0.187265L75.166957 484.739123c-7.120165 7.120165-10.163477 17.065677-8.990768 26.624381-1.500167 9.755178 1.5104 20.010753 8.990768 27.491121l411.660734 411.660734c12.258185 12.258185 32.892131 12.432147 45.511543-0.187265 12.707416-12.707416 12.7023-32.995485 0.187265-45.51052z" p-id="1115"></path></svg>
            </a>
        
        
            <a class="next" href="/post/use-haproxy/" title="HAProxy优化应用程序速度">
                <svg t="1542528747675" class="icon" style="width: 1em; height: 1em;vertical-align: middle;fill: currentColor;overflow: hidden;" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="997" data-spm-anchor-id="a313x.7781069.0.i0"><path d="M492.675886 904.817574L885.696074 511.797385 492.675886 118.777197c-12.258185-12.258185-12.432147-32.892131 0.187265-45.51052 12.707416-12.707416 32.995485-12.703323 45.511543-0.187265l411.660734 411.660734c7.120165 7.120165 10.163477 17.065677 8.990768 26.624381 1.500167 9.755178-1.5104 20.010753-8.990768 27.491121L538.374694 950.515359c-12.258185 12.258185-32.892131 12.432147-45.511543-0.187265-12.707416-12.707416-12.703323-32.995485-0.187265-45.51052z" p-id="998"></path></svg>
            </a>
        
    </div>
</div>
<footer class="footer">
    <div class="footer-nav">
    </div>
</footer>
<script type="text/javascript" src="/js/main.js"></script>
<script src="https://lib.baomitu.com/vue/2.5.17/vue.min.js"></script>
<script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?3ead3d84d47c5d12ba92a5cd59b5d750";
      var s = document.getElementsByTagName("script")[0]; 
      s.parentNode.insertBefore(hm, s);
    })();
</script>
</body>
</html>
